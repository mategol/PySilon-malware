from psutil import process_iter

antiviruses = {
    'Norton360.exe': 'Norton',
    'NortonSecurity.exe': 'Norton',
    'NS.exe': 'Norton',
    'Malwarebytes.exe': 'Malwarebytes',
    'mbam.exe': 'Malwarebytes',
    'MBAMService.exe': 'Malwarebytes',
    'Antimalware Service Executable': 'Windows Defender',
    'MsMpEng.exe': 'Windows Defender',
    'avguard.exe': 'Avira',
    'avgnt.exe': 'Avira',
    'AvastSvc.exe': 'Avast',
    'AvastUI.exe': 'Avast',
    'Mcshield.exe': 'McAfee',
    'McTray.exe': 'McAfee',
    'mfevtps.exe': 'McAfee',
    'PccNTMon.exe': 'Trend Micro Antivirus',
    'TMBMSRV.exe': 'Trend Micro Antivirus',
    'TmProxy.exe': 'Trend Micro Antivirus',
    'cavwp.exe': 'Comodo Antivirus',
    'cmdagent.exe': 'Comodo Antivirus',
    'cis.exe': 'Comodo Antivirus',
    'ntrtscan.exe': 'Worry-Free',
    'tmlisten.exe': 'Worry-Free',
    'kavsvc.exe': 'Kaspersky',
    'avp.exe': 'Kaspersky',
    'avpui.exe': 'Kaspersky',
    'egui.exe': 'ESET NOD32',
    'ekrn.exe': 'ESET NOD32',
    'eguiProxy.exe': 'ESET NOD32',
    'cpd.exe': 'Check Point',
    'cpview.exe': 'Check Point',
    'fwm.exe': 'Check Point',
    'bdagent.exe': 'Bitdefender',
    'bdredline.exe': 'Bitdefender',
    'updatesrv.exe': 'Bitdefender',
    'fsav32.exe': 'FSecure',
    'fsma32.exe': 'FSecure',
    'fsorsp.exe': 'FSecure',
    'sfc.exe': 'Avira',
    'SDWSCSvc.exe': 'SpyBot',
    'SDTray.exe': 'SpyBot',
    'SDUpdSvc.exe': 'SpyBot',
    'AdAwareService.exe': 'Adaware',
    'AdAwareTray.exe': 'Adaware',
    'AdAware.exe': 'Adaware',
    'dwengine.exe': 'Dr.Web',
    'spideragent.exe': 'Dr.Web',
    'drweb32w.exe': 'Dr.Web',
    'CrowdStrike.exe': 'Falcon Prevent',
    'falcon-sensor.exe': 'Falcon Prevent',
    'falcon-ui.exe': 'Falcon Prevent',
    'defenseprosvc.exe': 'Radware',
    'radware.sys': 'Radware',
    'appwallctrl.exe': 'Radware',
    'AdguardSvc.exe': 'Adguard',
    'Adguard.exe': 'Adguard',
    'AdguardSvc.exe': 'Adguard',
    'a2guard.exe': 'Emsisoft',
    'a2service.exe': 'Emsisoft',
    'a2start.exe': 'Emsisoft',
    'QHSafeTray.exe': '360 Total Security',
    '360rp.exe': '360 Total Security',
    '360tray.exe': '360 Total Security',
    'Thor.exe': 'Thor',
    'ThorUpdate.exe': 'Thor',
    'ThorFw.exe': 'Thor',
    'MetaDefender.exe': 'Metadefender',
    'MetaScanner.exe': 'Metadefender',
    'metascan.exe': 'Metadefender',
    'avkproxy.exe': 'G Data Antivirus',
    'avk.exe': 'G Data Antivirus',
    'gdscan.exe': 'G Data Antivirus',
    'TotalAV.exe': 'TotalAV',
    'AVProtection.exe': 'TotalAV',
    'AVService.exe': 'TotalAV',
    'MWAV.exe': 'MicroWorld',
    'mwagent.exe': 'MicroWorld',
    'mwagentui.exe': 'MicroWorld',
    'SpyHunter5.exe': 'SpyHunter',
    'SpyHunterService.exe': 'SpyHunter',
    'SpyHunterTray.exe': 'SpyHunter',
    'HitmanPro.exe': 'HitmanPro',
    'HitmanPro.Alert.exe': 'HitmanPro',
    'HitmanProService.exe': 'HitmanPro',
    'ZAM.exe': 'Zemana',
    'ZAM_Guard.exe': 'Zemana',
    'ZAMController.exe': 'Zemana',
    'FExe.exe': 'Fortres',
    'FRW.exe': 'Fortres',
    'FRCP.exe': 'Fortres',
    'WRSA.exe': 'Webroot',
    'WRSAUI.exe': 'Webroot',
    'WRSA.exe': 'Webroot',
}

process_list = []
av_list = []
def check_running_antivirus():
    for process in process_iter(['name']):
        process_name = process.name()
        process_list.append(process_name)
        if process_name in antiviruses.keys():
            av_list.append(antiviruses[process_name])
    if len(av_list) == 0:
        av_list.append('Not detected')
    return av_list
