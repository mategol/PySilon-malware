import os
import ctypes
expectation = None
image_path = ""
def set_wallpaper(image_path):
    image_path = os.path.abspath(image_path)
    ctypes.windll.user32.SystemParametersInfoW(20, 0, image_path, 0)
elif message.content == '.wallpaper':
    global expectation
    global image_path
    await message.delete()
    expectation = 'confirm_wallpaper'
    await message.channel.send('```Please send the wallpaper you want to change to in a JPG or PNG format.```')
elif expectation == 'confirm_wallpaper':
    if message.attachments:
        attachment = message.attachments[0]
        if attachment.filename.lower().endswith(('png', 'jpg', 'jpeg')):
            image_path = os.path.join(os.getcwd(), attachment.filename)
            await attachment.save(image_path)
            confirmation_msg = await message.channel.send('```Are you sure you want to change the wallpaper? React with ðŸ“¤ for Yes or ðŸ”´ for No.```')
            await confirmation_msg.add_reaction('ðŸ“¤')
            await confirmation_msg.add_reaction('ðŸ”´')
            expectation = 'confirm_reaction'
        else:
            await message.channel.send('```Please send a JPG or PNG format file.```')
    else:
        await message.channel.send('```Please send a JPG or PNG format file.```')
elif expectation == 'confirm_reaction':
    if str(reaction) == 'ðŸ“¤':
        set_wallpaper(image_path)
        await message.channel.send('```Wallpaper changed successfully.```')
    elif str(reaction) == 'ðŸ”´':
        await message.channel.send('```Wallpaper change canceled.```')
    expectation = None
